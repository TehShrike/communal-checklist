<div class="container">
	<div class="row">
		<div class="col-xs-offset-3 col-xs-6">
			{{#error}}
			<div class="alert alert-danger">
				{{error}}
			</div>
			{{/error}}
		</div>
		<div class="col-xs-offset-3 col-xs-6">
			{{#warning}}
			<div class="alert alert-warning">
				{{warning}}
			</div>
			{{/warning}}
		</div>
	</div>

	{{#list}}

		<nav class="navbar navbar-inverse margin-bottom-0">
			<div class="container-fluid">
				<div class="navbar-header">
					<a class="navbar-brand" href="#/home">Communal Checklist</a>
				</div>
			</div>
		</nav>

		<div class="row">
			<div class="col-xs-12">
				<div class="page-header">
					{{#if editingName}}
						<input type="text"
								class="listName form-control"
								on-blur="nameKillFocus"
								on-change="nameChange"
								value="{{list.other.name}}"
								placeholder="My awesome list" >
					{{elseif list.other.name}}
						<h1 on-click="editName">
							{{list.other.name}} {{#canEdit}}<button class="btn btn-link btn-xs" on-click="editName">(edit)</button>{{/canEdit}}
						</h1>
					{{else}}
						<h1 on-click="editName">
							Unnamed list {{#canEdit}}<button class="btn btn-link btn-xs" on-click="editName">(edit name)</button>{{/canEdit}}
						</h1>
					{{/if}}
				</div>
			</div>
		</div>

		<div class="row margin-bottom-20">
			<div class="col-xs-4">
				<div>
					<label class="control-label">
						Enter your name to remember which checks are yours
					</label>
					<input type="text" class="current-name form-control" on-change="changeUserName" value="{{currentName}}">
				</div>
			</div>

			<div class="col-xs-4">
				<div>
					<label class="control-label">Share:</label>
					<input type="text" class="form-control" decorator="selectOnFocus" value="{{shareUrl}}" readonly>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-xs-8">
				<table class="table table-striped">
					<tbody>
						{{#list.items}}
							<tr>
								<td class="col-edit">
									{{#editingItem}}

										<button
												class="btn btn-primary btn-xs margin-top-minus-5"
												on-click="saveItem">
											Save
										</button>
									{{else}}
										<a
												on-click="editItem"
												class="{{^canEdit}}hide{{/canEdit}} cursor-pointer">
											Edit
										</a>
									{{/editingItem}}
								</td>
								<td>
									{{#editingItem}}
										<div class="margin-bottom-minus-5 margin-top-minus-5">
											<input type="text" on-change="saveItem" value="{{name}}" placeholder="Do cool thing">
											<input type="text" on-change="saveItem" value="{{url}}" placeholder="http://amazon.com/butts">
										</div>
									{{else}}
										{{#url}}
											<a href="{{url}}" target="_blank">{{name}}</a>
										{{else}}
											{{name}}
										{{/url}}
									{{/editingItem}}
								</td>
								<td class="col-checkboxes">
									{{#checkboxes}}
										<input type="checkbox"
												data-item-id="{{itemId}}"
												on-change="checkboxClicked"
												disabled="{{checkedBy && checkedBy !== currentName}}"
												title="{{canEdit ? checkedBy : ''}}"
												checked="{{checked}}">
									{{/checkboxes}}
								</td>
								<td class="col-icons">
									{{#canEdit}}
										<i class="fa fa-minus-square-o" data-item-id="{{itemId}}" on-click="removeCheckbox"></i>
										<i class="fa fa-plus-square-o" data-item-id="{{itemId}}" on-click="addCheckbox"></i>
										{{#editingItem}}
											<i class="fa fa-trash-o" data-item-id="{{itemId}}" on-click="removeItem"></i>
										{{/editingItem}}
									{{/canEdit}}
								</td>
							</tr>
						{{/list.items}}
					</tbody>
				</table>
			</div>
		</div>

		{{#canEdit}}
		<div class="row">
			<div class="col-xs-8">
				<label class="control-label">Add a new checklist item</label>
				<input type="text"
						class="form-control"
						placeholder="Pantaloons"
						value="{{newItemName}}"
						on-change="newItem">
			</div>
		</div>
		{{/canEdit}}
	{{/list}}
</div>
